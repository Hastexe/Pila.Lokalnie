<!DOCTYPE html>

<html>

<head>
    <meta name="viewport" content="width=device-width" />

    <title>Index</title>

    <link href="~/Scripts/bootstrap.min.css" rel="stylesheet" />

    <script src="~/Scripts/jquery-3.5.1.min.js"></script>
</head>

<body>

    <div id="tblbody">

        <table class="" id="tbldata">

            <thead>

                <tr>

                    <th>ID</th>

                    <th>USER_ID</th>

                    <th>TITLE</th>

                    <th>PRICE</th>

                    <th>CATEGORY</th>
                </tr>

            </thead>

            <tbody id="trow">

                @{

                    Html.RenderAction("PartialAdverts", "Adverts", new { Model = Model });

                }

            </tbody>

        </table>

        <div id="loadingdiv" style="text-align:center;display:none;margin-bottom:20px;">

            <img src="~/Resource/ajax-loader.gif" />

        </div>

    </div>


    <script>
        $(document).ready(function () {
            var pageindex = 2;
            var NoMoredata = false;
            var inProgress = false;

            $(window).on("scroll", function() {
                var docHeight = $(document).height();
                var winScrolled = $(window).height() + $(window).scrollTop();
                if ((docHeight - winScrolled) < 1) {
                    console.log("module scrolled to bottom");
                    inProgress = true;
                    $("#loadingdiv").show();

                    $.post("@Url.Action("InfiniteScroll", "Adverts")", { "pageindex": pageindex },
                    function (data) {
                        pageindex = pageindex + 1;
                        NoMoredata = data.NoMoredata;
                        $("#trow").append(data.HTMLString);
                        $("#loadingdiv").hide();
                        inProgress = false;
                    }
                    );
                }
            });
        })
    </script>

</body>

</html>